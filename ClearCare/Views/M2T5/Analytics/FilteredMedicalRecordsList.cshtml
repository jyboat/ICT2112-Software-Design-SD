@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewData["Title"] = ViewData["Title"] ?? "Filtered Records";
    var records = ViewData["Records"] as List<Dictionary<string, object>>;
}

<h2 class="mt-4">@ViewData["Title"]</h2>

@if (records == null || records.Count == 0)
{
    <div class="alert alert-warning">No medical records found.</div>
}
else
{
    <table class="table table-bordered table-striped mt-3">
        <thead class="table-dark">
            <tr>
                <th>Record ID</th>
                <th>Doctor ID</th>
                <th>Patient ID</th>
                <th>Date</th>
                <th>Has Attachment</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var record in records)
            {
                var recordId = record["RecordId"]?.ToString();
                var date = ((Google.Cloud.Firestore.Timestamp)record["Date"]).ToDateTime().ToString("yyyy-MM-dd");

                <tr>
                    <td>@recordId</td>
                    <td>@record["DoctorID"]</td>
                    <td>@record["PatientID"]</td>
                    <td>@date</td>
                    <td>@(record.ContainsKey("Attachment") && record["Attachment"] != null ? "✅ Yes" : "❌ No")</td>
                </tr>
            }
        </tbody>
    </table>
}
